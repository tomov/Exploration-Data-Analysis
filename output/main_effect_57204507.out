
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_TU_badre.mat
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_36_56_-8_r=10mm.nii

p =

    0.9180


t =

    0.1038


b =

  Columns 1 through 7

    0.0220    0.0450   -0.2154    0.1129   -0.0989    0.2833    0.0290

  Columns 8 through 14

    0.1760    0.0653   -0.0409   -0.0411    0.1806   -0.1230   -0.1012

  Columns 15 through 21

   -0.3123    0.0049    0.2090   -0.1669    0.0434    0.0824    0.0956

  Columns 22 through 28

    0.0147   -0.0665    0.1100    0.0411    0.0199   -0.0147   -0.0958

  Columns 29 through 31

   -0.2224    0.2061   -0.1619

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_40_60_-10_r=10mm.nii

p =

    0.8308


t =

    0.2156


b =

  Columns 1 through 7

    0.0456    0.0334   -0.2028    0.1175   -0.1527    0.3821    0.0887

  Columns 8 through 14

    0.1733    0.0453   -0.0852   -0.0166    0.2115   -0.1532   -0.1115

  Columns 15 through 21

   -0.3653    0.0088    0.2514   -0.2151    0.0547    0.0928    0.1019

  Columns 22 through 28

    0.0392   -0.0580    0.1468    0.0992    0.0188   -0.0289   -0.0897

  Columns 29 through 31

   -0.2447    0.2324   -0.2202

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_30_52_-14_r=10mm.nii

p =

    0.6428


t =

    0.4685


b =

  Columns 1 through 7

    0.0728    0.0608   -0.1289    0.0799   -0.0503    0.1652    0.0312

  Columns 8 through 14

    0.1633    0.0645    0.0334   -0.0183    0.1147   -0.0964   -0.0572

  Columns 15 through 21

   -0.1913   -0.0039    0.1261   -0.1180    0.0181    0.0343    0.0988

  Columns 22 through 28

    0.0063   -0.0708    0.0427   -0.0121    0.0127    0.0028   -0.0594

  Columns 29 through 31

   -0.1555    0.1882   -0.1029

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_35_50_15_r=10mm.nii

p =

    0.0303


t =

    2.2735


b =

  Columns 1 through 7

    0.0787    0.0335   -0.2058    0.0912   -0.0697    0.2141    0.0106

  Columns 8 through 14

    0.1424    0.1919    0.0416   -0.1019    0.1516    0.0582   -0.1391

  Columns 15 through 21

    0.0828    0.0558    0.1972   -0.0980    0.0332    0.1589    0.1829

  Columns 22 through 28

   -0.0094   -0.0142    0.1106    0.1638    0.0773   -0.0138   -0.0312

  Columns 29 through 31

   -0.1909    0.1877    0.0643

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_24_48_20_r=10mm.nii

p =

    0.1111


t =

    1.6417


b =

  Columns 1 through 7

    0.0351    0.0710   -0.2219    0.0512   -0.1445    0.0937   -0.0561

  Columns 8 through 14

    0.0892    0.1620    0.0320   -0.0770    0.1044    0.0477   -0.0699

  Columns 15 through 21

    0.0690    0.0744    0.1512   -0.0641    0.0092    0.1638    0.1145

  Columns 22 through 28

   -0.0110    0.0267    0.0413    0.0775    0.0007    0.0352    0.0088

  Columns 29 through 31

   -0.1394    0.1965   -0.0022

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_30_52_16_r=10mm.nii

p =

    0.1619


t =

    1.4340


b =

  Columns 1 through 7

    0.0484    0.0386   -0.2664    0.0889   -0.1433    0.1620   -0.0280

  Columns 8 through 14

    0.1133    0.1954    0.0320   -0.1092    0.1166    0.0272   -0.1476

  Columns 15 through 21

    0.0635    0.0701    0.1996   -0.0937    0.0143    0.1802    0.1633

  Columns 22 through 28

   -0.0167   -0.0102    0.0849    0.1672    0.0303   -0.0157   -0.0410

  Columns 29 through 31

   -0.2070    0.2188    0.0388

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_18_40_22_r=10mm.nii

p =

    0.2958


t =

    1.0641


b =

  Columns 1 through 7

    0.0301    0.0686   -0.1340    0.0471   -0.0581    0.0434   -0.0807

  Columns 8 through 14

    0.0310    0.0810   -0.0016   -0.0580    0.0657    0.0437    0.0003

  Columns 15 through 21

   -0.0305    0.0469    0.0667   -0.0420    0.0199    0.0848    0.0821

  Columns 22 through 28

   -0.0025    0.0207    0.0098   -0.0030    0.0068    0.0253    0.0053

  Columns 29 through 31

   -0.1089    0.1302   -0.0383

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_24_46_20_r=10mm.nii

p =

    0.0668


t =

    1.9023


b =

  Columns 1 through 7

    0.0429    0.0758   -0.1931    0.0435   -0.1125    0.0938   -0.0539

  Columns 8 through 14

    0.0880    0.1388    0.0281   -0.0720    0.0981    0.0498   -0.0487

  Columns 15 through 21

    0.0652    0.0665    0.1342   -0.0593    0.0088    0.1458    0.1130

  Columns 22 through 28

   -0.0087    0.0331    0.0439    0.0561    0.0061    0.0416    0.0116

  Columns 29 through 31

   -0.1179    0.1783   -0.0081

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_30_52_-14_r=10mm.nii

p =

    0.6428


t =

    0.4685


b =

  Columns 1 through 7

    0.0728    0.0608   -0.1289    0.0799   -0.0503    0.1652    0.0312

  Columns 8 through 14

    0.1633    0.0645    0.0334   -0.0183    0.1147   -0.0964   -0.0572

  Columns 15 through 21

   -0.1913   -0.0039    0.1261   -0.1180    0.0181    0.0343    0.0988

  Columns 22 through 28

    0.0063   -0.0708    0.0427   -0.0121    0.0127    0.0028   -0.0594

  Columns 29 through 31

   -0.1555    0.1882   -0.1029

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_36_56_-10_r=10mm.nii

p =

    0.8639


t =

    0.1729


b =

  Columns 1 through 7

    0.0460    0.0484   -0.1949    0.1073   -0.1037    0.2822    0.0439

  Columns 8 through 14

    0.1788    0.0628   -0.0356   -0.0290    0.1754   -0.1334   -0.0850

  Columns 15 through 21

   -0.3058    0.0050    0.2040   -0.1705    0.0363    0.0722    0.0955

  Columns 22 through 28

    0.0165   -0.0693    0.0977    0.0425    0.0208   -0.0117   -0.0874

  Columns 29 through 31

   -0.2154    0.2099   -0.1716

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_22_56_26_r=10mm.nii

p =

    0.6221


t =

    0.4980


b =

  Columns 1 through 7

   -0.0209    0.0539   -0.3593    0.1006   -0.2563    0.0442   -0.0701

  Columns 8 through 14

    0.0719    0.2734    0.0174   -0.0912    0.1275    0.0409   -0.1528

  Columns 15 through 21

    0.0032    0.0830    0.1689   -0.0642    0.0313    0.2434    0.0963

  Columns 22 through 28

   -0.0323   -0.0296    0.0298    0.0904   -0.0329    0.0188   -0.0038

  Columns 29 through 31

   -0.2322    0.2495   -0.0139

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_26_52_16_r=10mm.nii

p =

    0.3802


t =

    0.8907


b =

  Columns 1 through 7

    0.0192    0.0381   -0.2783    0.0844   -0.1809    0.1132   -0.0589

  Columns 8 through 14

    0.0862    0.1849    0.0260   -0.1000    0.0954    0.0114   -0.1322

  Columns 15 through 21

    0.0402    0.0703    0.1758   -0.0801    0.0030    0.1786    0.1363

  Columns 22 through 28

   -0.0207   -0.0117    0.0486    0.1389   -0.0043   -0.0023   -0.0396

  Columns 29 through 31

   -0.1976    0.2290    0.0091

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_44_42_28_r=10mm.nii

p =

   2.7354e-05


t =

    4.9431


b =

  Columns 1 through 7

    0.1843    0.1248   -0.1747    0.1732    0.0650    0.3368    0.2000

  Columns 8 through 14

    0.2560    0.3512    0.0590   -0.0086    0.3975    0.1803    0.0318

  Columns 15 through 21

    0.0112    0.0262    0.2501   -0.0657    0.0979    0.1944    0.3187

  Columns 22 through 28

    0.0525    0.0210    0.2110    0.1077    0.0850    0.0278    0.0835

  Columns 29 through 31

   -0.1661    0.2143    0.1628

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_22_54_28_r=10mm.nii

p =

    0.4099


t =

    0.8358


b =

  Columns 1 through 7

   -0.0050    0.0853   -0.3386    0.1010   -0.2242    0.0618   -0.0632

  Columns 8 through 14

    0.0833    0.2599    0.0272   -0.0936    0.1388    0.0531   -0.1362

  Columns 15 through 21

    0.0101    0.0821    0.1505   -0.0689    0.0458    0.2311    0.0969

  Columns 22 through 28

   -0.0250   -0.0126    0.0533    0.0578   -0.0228    0.0243    0.0131

  Columns 29 through 31

   -0.2077    0.2376   -0.0086

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_28_48_14_r=10mm.nii

p =

    0.1416


t =

    1.5098


b =

  Columns 1 through 7

    0.0464    0.0489   -0.2016    0.0693   -0.1022    0.1333   -0.0412

  Columns 8 through 14

    0.1041    0.1267    0.0380   -0.0833    0.0886    0.0138   -0.0934

  Columns 15 through 21

    0.0444    0.0535    0.1483   -0.0817   -0.0000    0.1290    0.1408

  Columns 22 through 28

   -0.0134   -0.0018    0.0604    0.1042    0.0208    0.0116   -0.0356

  Columns 29 through 31

   -0.1438    0.1782    0.0078

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_rlpfc_22_46_20_r=10mm.nii

p =

    0.1706


t =

    1.4041


b =

  Columns 1 through 7

    0.0261    0.0728   -0.1874    0.0415   -0.1195    0.0695   -0.0664

  Columns 8 through 14

    0.0688    0.1278    0.0209   -0.0689    0.0854    0.0409   -0.0453

  Columns 15 through 21

    0.0425    0.0640    0.1159   -0.0558    0.0091    0.1331    0.1004

  Columns 22 through 28

   -0.0092    0.0248    0.0239    0.0406   -0.0043    0.0384    0.0045

  Columns 29 through 31

   -0.1183    0.1707   -0.0248


ans =

  16×4 table

                 Var1                  p_uncorr       p_corr          m    
    ______________________________    __________    __________    _________

    'badre_rlpfc_36_56_-8_r=10mm'        0.91804             1    0.0025964
    'badre_rlpfc_40_60_-10_r=10mm'       0.83078             1    0.0064292
    'badre_rlpfc_30_52_-14_r=10mm'       0.64284             1    0.0080903
    'badre_rlpfc_35_50_15_r=10mm'       0.030321       0.38899     0.046917
    'badre_rlpfc_24_48_20_r=10mm'        0.11109       0.84805     0.028026
    'badre_rlpfc_30_52_16_r=10mm'        0.16191       0.94075      0.03145
    'badre_rlpfc_18_40_22_r=10mm'        0.29578       0.99634     0.011353
    'badre_rlpfc_24_46_20_r=10mm'       0.066771       0.66901     0.028673
    'badre_rlpfc_30_52_-14_r=10mm'       0.64284             1    0.0080903
    'badre_rlpfc_36_56_-10_r=10mm'       0.86386             1    0.0042584
    'badre_rlpfc_22_56_26_r=10mm'         0.6221             1     0.012415
    'badre_rlpfc_26_52_16_r=10mm'        0.38018       0.99953     0.018776
    'badre_rlpfc_44_42_28_r=10mm'     2.7354e-05    0.00043757      0.12287
    'badre_rlpfc_22_54_28_r=10mm'        0.40988       0.99978     0.019573
    'badre_rlpfc_28_48_14_r=10mm'        0.14157       0.91304     0.024842
    'badre_rlpfc_22_46_20_r=10mm'        0.17057       0.94983     0.020051

