
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE john_roi_analysis_4.m-------------------
% See how many (unsmoothed) voxels in Str are "tuned" to G
% kind of how they do it all the time in multiunit recordings:
% find all voxels that have p < 0.01 for correlating with G
%

printcode;

clear all;

%masks = {'masks/striatum.nii', 'masks/putamen.nii', 'masks/caudate.nii', 'masks/pallidum.nii', 'masks/v1.nii', 'masks/s1.nii', 'masks/m1.nii', 'masks/hippocampus.nii'};
masks = {'masks/striatum.nii', 'masks/pallidum.nii'};

glmodels = 1019:1027; % use nosmooth betas -- nothing shows up for smooth
data = load_data;
EXPT_nosmooth = exploration_expt_nosmooth();

n = length(masks) * length(glmodels);

[~,~,goodRuns] = exploration_getSubjectsDirsAndRuns();

alpha = 0.01; % significance level

for glmodel = glmodels
    for i = 1:length(masks)
        mask = masks{i};
        [~, masknames{i}, ~] = fileparts(mask);
        m = load_mask(mask);

        clear t_G;
        clear p_G;
        for s = 1:length(data)
            t_G(s,:) = ccnl_get_tmap(EXPT_nosmooth, glmodel, 'G', mask, s);

            runs = find(goodRuns{s});
            data(s).exclude = ~ismember(data(s).run, runs) | data(s).timeout; % exclude bad runs and timeout trials
            n = sum(~data(s).exclude);
            p_G(s,:) = 2 * tcdf(abs(t_G(s,:)), n - 1, 'upper');
        end

        pos_Gs = sum(p_G < alpha, 2);
        pos_G(i,:) = mean(pos_Gs);
        pos_G_sem(i,:) = std(pos_Gs) / sqrt(size(t_G, 2));
        sz(i,:) = sum(m(:));

        fprintf('%s: %.4f +- %.4f (out of %d)\n', masknames{i}, pos_G(i), pos_G_sem(i), sz(i));
    end

    disp(['GLM ', num2str(glmodel)]);
    table(masknames', pos_G, pos_G_sem, sz, pos_G ./ sz)
end

--------------------- END FILE john_roi_analysis_4.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 25.1935 +- 0.1003 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 2.4194 +- 0.0784 (out of 573)
GLM 1019

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    25.194     0.10025     4029    0.0062531
    'pallidum'    2.4194    0.078359      573    0.0042223

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 25.0968 +- 0.1223 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 2.4516 +- 0.0834 (out of 573)
GLM 1020

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    25.097     0.12226     4029     0.006229
    'pallidum'    2.4516    0.083439      573    0.0042786

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 23.7742 +- 0.1018 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 1.9677 +- 0.0633 (out of 573)
GLM 1021

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    23.774     0.10183     4029    0.0059008
    'pallidum'    1.9677    0.063341      573    0.0034341

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 26.1290 +- 0.1319 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 2.2903 +- 0.0772 (out of 573)
GLM 1022

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    26.129     0.13192     4029    0.0064852
    'pallidum'    2.2903    0.077176      573    0.0039971

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 26.2581 +- 0.1240 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 2.5161 +- 0.0869 (out of 573)
GLM 1023

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    26.258     0.12398     4029    0.0065173
    'pallidum'    2.5161    0.086876      573    0.0043912

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 22.5484 +- 0.1126 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 1.9677 +- 0.0624 (out of 573)
GLM 1024

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    22.548     0.11257     4029    0.0055965
    'pallidum'    1.9677    0.062416      573    0.0034341

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 26.0968 +- 0.1418 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 1.8065 +- 0.0686 (out of 573)
GLM 1025

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    26.097     0.14175     4029    0.0064772
    'pallidum'    1.8065    0.068576      573    0.0031526

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 24.7419 +- 0.1146 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 2.2258 +- 0.0745 (out of 573)
GLM 1026

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    24.742     0.11462     4029     0.006141
    'pallidum'    2.2258    0.074504      573    0.0038845

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
striatum: 23.0323 +- 0.0963 (out of 4029)
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
pallidum: 1.9032 +- 0.0641 (out of 573)
GLM 1027

ans =

  2×5 table

       Var1       pos_G     pos_G_sem     sz       Var5   
    __________    ______    _________    ____    _________

    'striatum'    23.032    0.096302     4029    0.0057166
    'pallidum'    1.9032    0.064136      573    0.0033215

