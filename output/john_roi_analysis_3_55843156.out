
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE john_roi_analysis_3.m-------------------
% correlate BG with model G and N
% use nonsmooth betas averaged within the ROI
% do a t-test across subjects
% similar to badre_2012_roi_analysis_1.m
%

printcode;

clear all;

%masks = {'masks/striatum.nii', 'masks/putamen.nii', 'masks/caudate.nii', 'masks/pallidum.nii', 'masks/v1.nii', 'masks/s1.nii', 'masks/m1.nii', 'masks/hippocampus.nii'};
masks = {'masks/striatum.nii', 'masks/pallidum.nii'};

glmodels = 1019:1027;
data = load_data;
EXPT = exploration_expt_nosmooth();

n = length(masks) * length(glmodels);

for glmodel = glmodels
    for i = 1:length(masks)
        mask = masks{i};
        [~, masknames{i}, ~] = fileparts(mask);

        b_G = ccnl_roi_glm(EXPT, glmodel, mask, 'G');

        [h, p, ci, stats] = ttest(b_G);
        t_G(i,:) = stats.tstat;
        ps_G(i,:) = p;
        w_G(i,:) = mean(b_G);

        %[h, p, ci, stats] = ttest(b_N);
        %t_N(i,:) = stats.tstat;
        %ps_N(i,:) = p;
        %w_N(i,:) = mean(b_N);

        disp([mask, ', G']);
        t_G(i,:)
        p
        w_G(i,:)

        %disp([mask, ', N']);
        %t_N(i,:)
        %p
        %w_N(i,:)
    end

    G_uncorr = ps_G;
    G_corr = 1 - (1 - ps_G) .^ length(ps_G);

    %N_uncorr = ps_N;
    %N_corr = 1 - (1 - ps_N) .^ length(ps_N);

    disp(['GLM ', num2str(glmodel)]);
    table(masknames', G_uncorr, G_corr, w_G, t_G)
    %table(masknames', G_uncorr, N_uncorr, G_corr, N_corr, w_G, w_N, t_G, t_N)
end

--------------------- END FILE john_roi_analysis_3.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

   -0.3872


p =

    0.7014


ans =

  -1.3401e-04

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    0.3001


p =

    0.7662


ans =

   1.0301e-04

GLM 1019

ans =

  2×5 table

       Var1       G_uncorr    G_corr         w_G          t_G   
    __________    ________    _______    ___________    ________

    'striatum'    0.70137     0.91082    -0.00013401    -0.38716
    'pallidum'     0.7662     0.94534     0.00010301     0.30006

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

   -0.3654


p =

    0.7174


ans =

  -7.8657e-04

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

   -0.0321


p =

    0.9746


ans =

  -6.2979e-05

GLM 1020

ans =

  2×5 table

       Var1       G_uncorr    G_corr         w_G           t_G   
    __________    ________    _______    ___________    _________

    'striatum'     0.7174     0.92014    -0.00078657     -0.36537
    'pallidum'    0.97459     0.99935    -6.2979e-05    -0.032123

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

    0.8777


p =

    0.3871


ans =

    0.0642

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

   -0.1463


p =

    0.8846


ans =

   -0.0076

GLM 1021

ans =

  2×5 table

       Var1       G_uncorr    G_corr        w_G          t_G   
    __________    ________    _______    __________    ________

    'striatum'    0.38708     0.62433      0.064221     0.87769
    'pallidum'    0.88464     0.98669    -0.0075513    -0.14633

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

    0.5765


p =

    0.5686


ans =

    0.0051

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    1.1274


p =

    0.2685


ans =

    0.0059

GLM 1022

ans =

  2×5 table

       Var1       G_uncorr    G_corr        w_G         t_G  
    __________    ________    _______    _________    _______

    'striatum'    0.56856     0.81386    0.0050883    0.57652
    'pallidum'     0.2685     0.46491    0.0059155     1.1274

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

   -0.3069


p =

    0.7610


ans =

   -0.0018

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    1.1008


p =

    0.2797


ans =

    0.0064

GLM 1023

ans =

  2×5 table

       Var1       G_uncorr    G_corr        w_G          t_G   
    __________    ________    _______    __________    ________

    'striatum'    0.76101     0.94289    -0.0017534    -0.30694
    'pallidum'    0.27974     0.48123     0.0063695      1.1008

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

    0.0284


p =

    0.9775


ans =

    0.0011

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    1.3962


p =

    0.1729


ans =

    0.0814

GLM 1024

ans =

  2×5 table

       Var1       G_uncorr    G_corr        w_G         t_G   
    __________    ________    _______    _________    ________

    'striatum'     0.9775     0.99949    0.0010995    0.028445
    'pallidum'    0.17291     0.31593     0.081381      1.3962

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

   -0.1236


p =

    0.9025


ans =

   -0.0029

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

   -0.2402


p =

    0.8118


ans =

   -0.0065

GLM 1025

ans =

  2×5 table

       Var1       G_uncorr    G_corr        w_G          t_G   
    __________    ________    _______    __________    ________

    'striatum'    0.90248     0.99049    -0.0029013    -0.12356
    'pallidum'    0.81182     0.96459    -0.0065339    -0.24019

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

    0.5855


p =

    0.5626


ans =

    0.0271

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    1.0695


p =

    0.2934


ans =

    0.0455

GLM 1026

ans =

  2×5 table

       Var1       G_uncorr    G_corr       w_G         t_G  
    __________    ________    _______    ________    _______

    'striatum'    0.56256     0.80865    0.027106    0.58554
    'pallidum'    0.29339      0.5007    0.045455     1.0695

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/striatum.nii, G

ans =

    1.1174


p =

    0.2727


ans =

   1.0963e+04

mask
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 10
Subject 11
Subject 12
Subject 13
Subject 14
Subject 15
Subject 16
Subject 17
Subject 18
Subject 19
Subject 20
Subject 21
Subject 22
Subject 23
Subject 24
Subject 25
Subject 26
Subject 27
Subject 28
Subject 29
Subject 30
Subject 31
masks/pallidum.nii, G

ans =

    0.6685


p =

    0.5089


ans =

   6.1612e+03

GLM 1027

ans =

  2×5 table

       Var1       G_uncorr    G_corr      w_G        t_G  
    __________    ________    _______    ______    _______

    'striatum'    0.27268       0.471     10963     1.1174
    'pallidum'    0.50894     0.75886    6161.2    0.66848

