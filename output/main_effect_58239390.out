
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'dlpfc'
        % clusters = masks from paper
        masks = dlpfc_2012_create_masks(false);

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

if exist('region', 'var')
    masknames = region';
end
table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_TU_dlpfc.mat
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_dlpfc_40_30_34_r=10mm.nii

p =

   1.5545e-04


t =

    4.3245


b =

  Columns 1 through 7

    0.1220    0.1366   -0.1495    0.1694    0.0515    0.3043    0.2211

  Columns 8 through 14

    0.1933    0.2456    0.1054    0.0106    0.2308    0.0306    0.0974

  Columns 15 through 21

   -0.1540    0.0335    0.2568   -0.0983    0.1228    0.1555    0.2400

  Columns 22 through 28

    0.0266    0.0227    0.1307    0.0509    0.0252    0.0703    0.0846

  Columns 29 through 31

   -0.1488    0.2518    0.1071

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_dlpfc_38_30_34_r=10mm.nii

p =

   2.0778e-04


t =

    4.2202


b =

  Columns 1 through 7

    0.1087    0.1389   -0.1557    0.1481    0.0498    0.2901    0.2003

  Columns 8 through 14

    0.1865    0.2418    0.0926    0.0016    0.2085    0.0426    0.0971

  Columns 15 through 21

   -0.1419    0.0367    0.2372   -0.0898    0.1106    0.1540    0.2280

  Columns 22 through 28

    0.0236    0.0121    0.1200    0.0239    0.0219    0.0732    0.0797

  Columns 29 through 31

   -0.1427    0.2418    0.1047

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_dlpfc_30_26_20_r=10mm.nii

p =

    0.0018


t =

    3.4345


b =

  Columns 1 through 7

    0.0843    0.0808   -0.0837    0.0648    0.0453    0.1286   -0.0011

  Columns 8 through 14

    0.0616    0.0814   -0.0015   -0.0457    0.0387    0.0386   -0.0233

  Columns 15 through 21

   -0.0226    0.0182    0.0882   -0.0266    0.0350    0.0548    0.0800

  Columns 22 through 28

   -0.0066    0.0154    0.0567   -0.0025    0.0265    0.0391    0.0378

  Columns 29 through 31

   -0.0463    0.0870    0.0164

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/badre_dlpfc_46_14_28_r=10mm.nii

p =

   1.8694e-06


t =

    5.8952


b =

  Columns 1 through 7

    0.2187    0.1857   -0.1642    0.1928    0.1717    0.3480    0.0525

  Columns 8 through 14

    0.2015    0.1957    0.1877   -0.0321    0.1916    0.0324    0.0949

  Columns 15 through 21

    0.0474    0.0538    0.1721   -0.0263    0.1557    0.1612    0.2806

  Columns 22 through 28

   -0.0235    0.0313    0.2058    0.2482    0.1350    0.1373    0.1204

  Columns 29 through 31

   -0.0883    0.2149    0.0318


ans =

  4×4 table

                Var1                  p_uncorr       p_corr         m    
    _____________________________    __________    __________    ________

    'badre_dlpfc_40_30_34_r=10mm'    0.00015545    0.00062165    0.095048
    'badre_dlpfc_38_30_34_r=10mm'    0.00020778    0.00083086    0.088521
    'badre_dlpfc_30_26_20_r=10mm'     0.0017564      0.007007    0.029654
    'badre_dlpfc_46_14_28_r=10mm'    1.8694e-06    7.4775e-06     0.12046

