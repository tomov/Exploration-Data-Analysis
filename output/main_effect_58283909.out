
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'dlpfc'
        % clusters = masks from paper
        masks = dlpfc_2012_create_masks(false);

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    bs{i} = b;
    cis{i} = ci;
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

if exist('region', 'var')
    masknames = region';
end
table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_RU_RU_-_trial.mat
bspm_extract_clusters(/ncf/gershman/Lab/Exploration/glmOutput/model21/con5/spmT_0001.nii, 0.001000, +, 0.050000, 20, 1, 30, /ncf/gershman/Lab/scripts/ccnl-fmri-2018/atlases, AAL2)
[Warning: No voxels found after cluster FWE correction. Setting extent threshold
= 5.] 
[> In ccnl_extract_clusters>bspm_extract_clusters (line 146)
  In ccnl_extract_clusters (line 85)
  In main_effect (line 36)] 
  Columns 1 through 6

    'Positive'    'Location not in ...'    [102]    [4.9221]    [ 22]    [ 36]
            []    'Frontal_Mid_2_R'        [177]    [4.7206]    [ 34]    [ 50]
            []    'Parietal_Inf_R'         [ 49]    [4.4973]    [ 52]    [-58]
            []    'Location not in ...'    [  7]    [4.0179]    [-52]    [-56]
            []    'Frontal_Sup_2_L'        [  6]    [4.0130]    [-20]    [ 48]
            []    'Frontal_Mid_2_R'        [ 48]    [3.7128]    [ 42]    [ 26]
            []    'Frontal_Mid_2_L'        [ 55]    [3.6813]    [-34]    [ 48]

  Column 7

    [ -2]
    [-10]
    [ 50]
    [ 52]
    [-12]
    [ 38]
    [ -4]

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_22_36_-2_r=10mm.nii

p =

    0.0058


t =

    2.9683


b =

  Columns 1 through 7

    0.0833    0.0243    0.0470    0.0725    0.0628    0.0175    0.0148

  Columns 8 through 14

    0.0153   -0.0078   -0.0458   -0.0425   -0.0235    0.0117   -0.0473

  Columns 15 through 21

    0.1226    0.0250    0.0340   -0.0082    0.0067   -0.0334    0.0788

  Columns 22 through 28

    0.0820    0.0301    0.0901    0.0451    0.0493    0.0255    0.0213

  Columns 29 through 31

   -0.0312   -0.0053    0.0030

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_34_50_-10_r=10mm.nii

p =

    0.0013


t =

    3.5507


b =

  Columns 1 through 7

    0.3291    0.1398    0.0073    0.1221    0.3442    0.2302    0.3856

  Columns 8 through 14

    0.0582    0.3103    0.0968    0.0935    0.0488   -0.0768    0.0174

  Columns 15 through 21

   -0.2684    0.1721    0.0664   -0.1661    0.1608   -0.0565    0.2348

  Columns 22 through 28

    0.0155    0.0306    0.1536   -0.0195    0.0474    0.0992    0.0523

  Columns 29 through 31

    0.0383    0.0171    0.1373

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_52_-58_50_r=10mm.nii

p =

    0.0018


t =

    3.4240


b =

  Columns 1 through 7

    0.6703    0.2646    0.1216    0.3849    0.4086    0.1585    0.0115

  Columns 8 through 14

    0.1048    0.2699    0.0864    0.2630    0.0510    0.0086    0.1479

  Columns 15 through 21

   -0.1833    0.2217    0.0077   -0.3192    0.1618   -0.0567    0.3186

  Columns 22 through 28

   -0.0245   -0.1221    0.1298   -0.0541    0.2156    0.1618    0.0605

  Columns 29 through 31

    0.2011   -0.1030    0.1062

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-52_-56_52_r=10mm.nii

p =

    0.0037


t =

    3.1460


b =

  Columns 1 through 7

    0.3676    0.3355   -0.1863    0.1480    0.1199    0.1393   -0.0018

  Columns 8 through 14

    0.0628    0.2310    0.2120    0.1757    0.0184   -0.0496    0.1440

  Columns 15 through 21

   -0.0584    0.0126    0.0269   -0.1481    0.2039    0.0072    0.1205

  Columns 22 through 28

   -0.0141   -0.0095    0.0449   -0.0493    0.0245    0.0171    0.1599

  Columns 29 through 31

    0.0805   -0.0529    0.1240

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-20_48_-12_r=10mm.nii

p =

   5.8572e-04


t =

    3.8436


b =

  Columns 1 through 7

    0.0756    0.0321    0.0230    0.1241    0.0212    0.0872    0.0428

  Columns 8 through 14

    0.0662    0.0698    0.0794   -0.0315   -0.0291   -0.0283   -0.0304

  Columns 15 through 21

    0.0059   -0.0186    0.0423    0.0511    0.0592    0.0273    0.1276

  Columns 22 through 28

    0.0450    0.0135    0.0737    0.0026    0.0376   -0.0116    0.0335

  Columns 29 through 31

   -0.0895    0.0488    0.0866

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_42_26_38_r=10mm.nii

p =

   9.9033e-04


t =

    3.6496


b =

  Columns 1 through 7

    0.3134    0.2535    0.1173    0.1235    0.2483    0.2766    0.2005

  Columns 8 through 14

   -0.0216    0.2351    0.0532    0.1138    0.0084    0.0059    0.0418

  Columns 15 through 21

   -0.0769    0.2127    0.0535   -0.1496    0.2050   -0.0883    0.1325

  Columns 22 through 28

    0.1135    0.0009    0.0155   -0.1602    0.0282    0.0974    0.0125

  Columns 29 through 31

    0.2589   -0.1107    0.1254

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-34_48_-4_r=10mm.nii

p =

    0.0068


t =

    2.9072


b =

  Columns 1 through 7

    0.2440    0.1395    0.0602   -0.0080    0.1004    0.1991    0.0923

  Columns 8 through 14

    0.0656    0.1047    0.2793   -0.0442   -0.0006   -0.0332    0.0118

  Columns 15 through 21

   -0.1864    0.0927   -0.0109   -0.0960    0.1513   -0.0758    0.1562

  Columns 22 through 28

    0.0136   -0.0646    0.0323    0.0750   -0.0168    0.0695    0.0465

  Columns 29 through 31

    0.0612    0.0278    0.1268


ans =

  7×4 table

             Var1               p_uncorr      p_corr         m    
    _______________________    __________    _________    ________

    'Location not in atlas'     0.0058357     0.040142    0.023142
    'Frontal_Mid_2_R'           0.0012903    0.0089974    0.091014
    'Parietal_Inf_R'            0.0018055     0.012571     0.11849
    'Location not in atlas'      0.003721     0.025758     0.07117
    'Frontal_Sup_2_L'          0.00058572    0.0040929    0.033465
    'Frontal_Mid_2_R'          0.00099033    0.0069118    0.085167
    'Frontal_Mid_2_L'           0.0067976     0.046624    0.052038

