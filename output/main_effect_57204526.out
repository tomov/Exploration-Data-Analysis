
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_TU_TU_-_trial.mat
bspm_extract_clusters(/ncf/gershman/Lab/Exploration/glmOutput/model21/con6/spmT_0001.nii, 0.001000, +, 0.050000, 20, 1, 30, /ncf/gershman/Lab/scripts/ccnl-fmri-2018/atlases, AAL2)
  Columns 1 through 6

    'Positive'    'Parietal_Inf_R'         [2042]    [7.5078]    [ 38]    [-46]
            []    'Parietal_Inf_L'         [1521]    [7.2982]    [-46]    [-40]
            []    'Location not in ...'    [ 468]    [6.2314]    [ 22]    [ -2]
            []    'Precentral_L'           [ 282]    [5.7913]    [-42]    [  2]
            []    'Precentral_R'           [ 258]    [4.8413]    [ 46]    [  8]
            []    'Insula_L'               [ 268]    [4.8153]    [-30]    [ 22]

  Column 7

    [44]
    [48]
    [52]
    [28]
    [30]
    [ 2]

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_38_-46_44_r=10mm.nii

p =

   7.3369e-10


t =

    8.8460


b =

  Columns 1 through 7

    0.1821    0.2018   -0.1106    0.1984    0.0621    0.3031    0.2499

  Columns 8 through 14

    0.2293    0.2735    0.1712    0.0258    0.1754    0.1355    0.1648

  Columns 15 through 21

    0.1655    0.1718    0.3287    0.0227    0.1243    0.1416    0.2485

  Columns 22 through 28

    0.0864    0.1201    0.2881    0.2459    0.1238    0.0043    0.1567

  Columns 29 through 31

    0.0034    0.1830    0.1623

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-46_-40_48_r=10mm.nii

p =

   1.2452e-10


t =

    9.5751


b =

  Columns 1 through 7

    0.3283    0.4018   -0.1497    0.2858    0.1462    0.3647    0.2403

  Columns 8 through 14

    0.2980    0.5108    0.4653    0.1252    0.1946    0.1872    0.2236

  Columns 15 through 21

    0.3472    0.1750    0.3039    0.0807    0.1425    0.1199    0.1961

  Columns 22 through 28

    0.0468    0.2957    0.2945    0.2376    0.1889    0.1258    0.2758

  Columns 29 through 31

    0.1046    0.1970    0.1693

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_22_-2_52_r=10mm.nii

p =

   3.6872e-08


t =

    7.3264


b =

  Columns 1 through 7

    0.1498    0.1388   -0.1978    0.1221    0.1469    0.2086    0.0741

  Columns 8 through 14

    0.1666    0.2040    0.0836   -0.0234    0.1392    0.1814    0.0888

  Columns 15 through 21

    0.2227    0.1723    0.1674    0.0524    0.0949    0.1121    0.1467

  Columns 22 through 28

    0.0374    0.0948    0.1568    0.1419    0.0313    0.1101    0.0960

  Columns 29 through 31

    0.0122    0.2185    0.0631

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-42_2_28_r=10mm.nii

p =

   2.0149e-08


t =

    7.5537


b =

  Columns 1 through 7

    0.2373    0.3526   -0.1953    0.1568    0.1365    0.2299    0.0728

  Columns 8 through 14

    0.2604    0.2944    0.2877    0.0264    0.1150    0.1779    0.1622

  Columns 15 through 21

    0.1185    0.0963    0.2691    0.0262    0.1525    0.0810    0.1715

  Columns 22 through 28

    0.0551    0.1009    0.2935    0.2338    0.0642    0.2532    0.1830

  Columns 29 through 31

    0.0290    0.1851    0.0538

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_46_8_30_r=10mm.nii

p =

   1.7344e-09


t =

    8.5022


b =

  Columns 1 through 7

    0.2923    0.2737   -0.1400    0.2163    0.2055    0.3677    0.0455

  Columns 8 through 14

    0.2277    0.2106    0.2765    0.0652    0.1702    0.2071    0.2107

  Columns 15 through 21

    0.1377    0.0692    0.2119    0.0723    0.1901    0.2244    0.3746

  Columns 22 through 28

    0.0267    0.0389    0.2163    0.3210    0.2190    0.1915    0.1571

  Columns 29 through 31

   -0.0244    0.2493    0.1033

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-30_22_2_r=10mm.nii

p =

   3.5162e-08


t =

    7.3442


b =

  Columns 1 through 7

    0.1575    0.2552   -0.1128    0.1006    0.0355    0.1813    0.0493

  Columns 8 through 14

    0.1383    0.1955    0.0270   -0.0104    0.1607    0.0712    0.1340

  Columns 15 through 21

    0.1361    0.0529    0.2596   -0.0016    0.1042    0.1099    0.1450

  Columns 22 through 28

    0.0466    0.0811    0.1118    0.1299    0.1197    0.0949    0.1737

  Columns 29 through 31

    0.0418    0.1207    0.0430


ans =

  6×4 table

                       Var1                         p_uncorr       p_corr         m   
    ___________________________________________    __________    __________    _______

    'sphere_glm21_TU_-_trial_38_-46_44_r=10mm'     7.3369e-10    4.4022e-09    0.15611
    'sphere_glm21_TU_-_trial_-46_-40_48_r=10mm'    1.2452e-10    7.4712e-10    0.22334
    'sphere_glm21_TU_-_trial_22_-2_52_r=10mm'      3.6872e-08    2.2123e-07    0.11011
    'sphere_glm21_TU_-_trial_-42_2_28_r=10mm'      2.0149e-08    1.2089e-07    0.15101
    'sphere_glm21_TU_-_trial_46_8_30_r=10mm'       1.7344e-09    1.0406e-08    0.17445
    'sphere_glm21_TU_-_trial_-30_22_2_r=10mm'      3.5162e-08    2.1097e-07    0.10169

