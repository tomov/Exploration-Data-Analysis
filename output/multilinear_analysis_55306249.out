
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE multilinear_analysis.m-------------------
% multilinear regression analysis 
% try to decode |RU| or TU from multivariate ROI activity and see if it predicts
% choices better than behavioral model alone
% merge of residuals_analysis.m and badre_2012_multilinear_analysis.m TODO dedupe?
%

function multilinear_analysis(glmodel, regressor, contrast, load_first_half)

printcode;

if ~exist('load_first_half', 'var')
    load_first_half = false;
end

filename = ['multilinear_analysis_', replace(contrast, ' ', '_'), '_glm', num2str(glmodel), '.mat'];
filename


if load_first_half
    % optionally load pre-computed residuals (b/c the 2nd half doesn't work on the stupid cluster...)
    load(filename);
else

    % group-level settings
    p = 0.001;
    alpha = 0.05;
    Dis = 20;
    Num = 1; % # peak voxels per cluster; default in bspmview is 3
    direct = '+';

    EXPT = exploration_expt();

    data = load_data;

    switch regressor
        case 'RU'
            formula_both = 'C ~ -1 + V + RU + VTU + decRU';
            formula_orig = 'C ~ -1 + V + RU + VTU';
            formula_dec = 'C ~ -1 + V + decRU + VTU';
        case 'TU'
            formula_both = 'C ~ -1 + V + RU + VTU + VdecTU';
            formula_orig = 'C ~ -1 + V + RU + VTU';
            formula_dec = 'C ~ -1 + V + RU + VdecTU';
        otherwise
            assert(false);
    end

    [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

    r = 10 / 1.5; % 10 mm radius

    % create spherical masks around peak voxel of each cluster (intersected with cluster)
    %
    for c = 1:length(region)
        masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
        cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
        ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
    end

    % extract trial_onset (raw, unsmoothed) betas
    %
    roi = extract_roi_betas(masks, 'trial_onset');

    save(filename, '-v7.3');
end


[~,~,goodRuns] = exploration_getSubjectsDirsAndRuns();

% clean up betas
%
for c = 1:length(roi)
    for s = 1:length(data)
        B = roi(c).subj(s).betas;
        runs = find(goodRuns{s});
        data(s).exclude = ~ismember(data(s).run, runs) | data(s).timeout; % exclude bad runs and timeout trials
        which_nan = any(isnan(B(~data(s).exclude, :)), 1); % exclude nan voxels (ignoring bad runs and timeouts; we exclude those in the GLMs)
        B(:, which_nan) = [];
        data(s).betas{c} = B;
    end
end

% extract regressors
%
V_all = [];
for s = 1:length(data)
    which_all = logical(ones(length(data(s).run), 1));
    switch regressor
        case 'RU'
            [~, absRU] =  get_latents(data, s, which_all, 'abs');
            [~, RU] = get_latents(data, s, which_all, 'left');
            data(s).y = absRU;
            data(s).RU = RU; % for sign-correction
        case 'TU'
            [V, ~, TU] = get_latents(data, s, which_all, 'left');
            data(s).y = TU;
            V_all = [V_all; V];
        otherwise
            assert(false);
    end
end

save(filename, '-v7.3');

for c = 1:numel(masks)
    mask = masks{c};
    [~, masknames{c}, ~] = fileparts(mask);
    disp(region{c});

    dec = [];
    exclude = [];
    rmse = [];
    for s = 1:length(data)
        exclude = [exclude; data(s).exclude];
        X = data(s).betas{c};
        y = data(s).y;
        mdl = fitlm(X, y, 'exclude', data(s).exclude, 'Intercept', true);
        pred = predict(mdl, X);
        if glmodel == 21 && strcmp(regressor, 'RU')
            pred = pred .* (data(s).RU >= 0) + (-pred) .* (data(s).RU < 0); % adjust for fact that we decode |RU|
        end
        dec = [dec; pred];
        rmse(s) = mdl.RMSE;
    end
    exclude = logical(exclude);

    tbl = data2table(data, 0, 0); % include all trials; we exclude bad runs and timeouts manually

    switch regressor
        case 'RU'
            decRU = dec;
            tbl = [tbl table(decRU)];
        case 'TU'
            VdecTU = V_all ./ dec;
            tbl = [tbl table(VdecTU)];
        otherwise
            assert(false);
    end

    % glm with both the model and decoded regressor
    results_both{c} = fitglme(tbl,formula_both,'Distribution','Binomial','Link','Probit','FitMethod','Laplace', 'CovariancePattern','diagonal', 'Exclude',exclude);
    [w, names, stats] = fixedEffects(results_both{c});
    ps(c,:) = stats.pValue';
    results_both{c}
    stats.pValue
    w
    names

    % original glm (model only)
    % do model comparison
    results_orig{c} = fitglme(tbl,formula_orig,'Distribution','Binomial','Link','Probit','FitMethod','Laplace', 'CovariancePattern','diagonal', 'Exclude',exclude);
    comp{c} = compare(results_orig{c}, results_both{c}); % order is important -- see docs
    comp{c}
    p_comp(c,:) = comp{c}.pValue(2);
    BIC(c,:) = comp{c}.BIC';

    % glm with decoded regressor only
    % do second model comparison
    results_dec{c} = fitglme(tbl,formula_dec,'Distribution','Binomial','Link','Probit','FitMethod','Laplace', 'CovariancePattern','diagonal', 'Exclude',exclude);
    comp2{c} = compare(results_dec{c}, results_both{c}); % order is important -- see docs
    comp2{c}
    p_comp2(c,:) = comp2{c}.pValue(2);
    BIC2(c,:) = comp2{c}.BIC';

    % correlate RMSE with behavioral weights across subjects
    % => see if better decodeability is associated with more reliance on regressor in decision
    %
    load results_glme_fig3_nozscore.mat;
    w = getEffects(results_VTURU, false);
    switch regressor
        case 'RU'
            [r, p] = corr(abs(w(:,2)), rmse');
        case 'TU'
            [r, p] = corr(abs(w(:,3)), rmse');
        otherwise
            assert(false);
    end
    disp('rmse to w');
    r
    p
    p_ax(c,:) = p;
    r_ax(c,:) = r;
end

save(filename, '-v7.3');

p_uncorr = ps(:,4);
p_corr = 1 - (1 - p_uncorr) .^ numel(p_uncorr);
BIC_orig = BIC(:,1);
BIC_both = BIC(:,2);
BIC_dec = BIC2(:,1);
table(region, p_uncorr, p_corr, BIC_orig, BIC_both, p_comp, BIC_dec, p_comp2, p_ax, r_ax)


--------------------- END FILE multilinear_analysis.m-------------------

filename =

    'multilinear_analysis_TU_-_trial_glm21.mat'

Parietal_Inf_R
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7504.5    7533.2    -3748.3          7496.5  

Fixed effects coefficients (95% CIs):
    Name            Estimate    SE           tStat         DF      pValue 
    'RU'            0.086965     0.004432        19.622    9475          0
    'VTU'            -1.3549       836.09    -0.0016205    9475    0.99871
    'V'              0.11914    0.0024797        48.045    9475          0
    'VdecTU'           1.355       836.09     0.0016206    9475    0.99871


    Lower       Upper   
    0.078278    0.095653
     -1640.3      1637.6
     0.11428       0.124
     -1637.6      1640.3

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

         0
    0.9987
         0
    0.9987


w =

    0.0870
   -1.3549
    0.1191
    1.3550


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat        deltaDF
    GLME       3     7502.5      7524    -3748.3                         
    ALTGLME    4     7504.5    7533.2    -3748.3    4.3784e-06    1      


    pValue 
           
    0.99833

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat        deltaDF
    GLME       3     7502.5      7524    -3748.3                         
    ALTGLME    4     7504.5    7533.2    -3748.3    4.3779e-06    1      


    pValue 
           
    0.99833

rmse to w

r =

   NaN


p =

   NaN

Parietal_Inf_L
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7504.5    7533.2    -3748.3          7496.5  

Fixed effects coefficients (95% CIs):
    Name            Estimate    SE           tStat         DF      pValue 
    'RU'            0.086965     0.004432        19.622    9475          0
    'VTU'           -0.54902       446.91    -0.0012285    9475    0.99902
    'V'              0.11914    0.0024797        48.045    9475          0
    'VdecTU'         0.54916       446.91     0.0012288    9475    0.99902


    Lower       Upper   
    0.078278    0.095653
     -876.59      875.49
     0.11428       0.124
     -875.49      876.59

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

         0
    0.9990
         0
    0.9990


w =

    0.0870
   -0.5490
    0.1191
    0.5492


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat        deltaDF
    GLME       3     7502.5      7524    -3748.3                         
    ALTGLME    4     7504.5    7533.2    -3748.3    5.7658e-07    1      


    pValue 
           
    0.99939

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat        deltaDF
    GLME       3     7502.5      7524    -3748.3                         
    ALTGLME    4     7504.5    7533.2    -3748.3    5.7644e-07    1      


    pValue 
           
    0.99939

rmse to w

r =

   NaN


p =

   NaN

Location not in atlas
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7501.5    7530.1    -3746.8          7493.5  

Fixed effects coefficients (95% CIs):
    Name            Estimate       SE            tStat      DF      pValue    
    'RU'               0.086947     0.0044317     19.619    9475             0
    'VTU'            0.00014959    2.4888e-05     6.0104    9475    1.9191e-09
    'V'                 0.11912     0.0024794     48.043    9475             0
    'VdecTU'        -2.1496e-05     1.155e-05    -1.8612    9475      0.062754


    Lower          Upper     
       0.078259      0.095634
      0.0001008    0.00019837
        0.11426       0.12398
    -4.4135e-05    1.1441e-06

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

         0
    0.0000
         0
    0.0628


w =

    0.0869
    0.0001
    0.1191
   -0.0000


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF
    GLME       3     7502.5      7524    -3748.3                     
    ALTGLME    4     7501.5    7530.1    -3746.8    3.0235    1      


    pValue  
            
    0.082067

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF
    GLME       3     7540.2    7561.7    -3767.1                     
    ALTGLME    4     7501.5    7530.1    -3746.8    40.718    1      


    pValue    
              
    1.7585e-10

rmse to w

r =

    0.1189


p =

    0.5242

Precentral_L
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7452.2    7480.9    -3722.1          7444.2  

Fixed effects coefficients (95% CIs):
    Name            Estimate       SE            tStat      DF      pValue    
    'RU'                0.08684     0.0044297     19.604    9475             0
    'VTU'            0.00028257    3.4938e-05     8.0878    9475    6.6613e-16
    'V'                 0.11899     0.0024768     48.043    9475             0
    'VdecTU'        -0.00033687    4.6092e-05    -7.3086    9475    2.9177e-13


    Lower          Upper      
       0.078157       0.095523
     0.00021408     0.00035106
        0.11414        0.12385
    -0.00042722    -0.00024652

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

   1.0e-12 *

         0
    0.0007
         0
    0.2918


w =

    0.0868
    0.0003
    0.1190
   -0.0003


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF
    GLME       3     7502.5      7524    -3748.3                     
    ALTGLME    4     7452.2    7480.9    -3722.1    52.293    1      


    pValue    
              
    4.7806e-13

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF    pValue
    GLME       3     7534.5      7556    -3764.3                               
    ALTGLME    4     7452.2    7480.9    -3722.1    84.258    1          0     

rmse to w

r =

    0.0835


p =

    0.6552

Precentral_R
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7504.5    7533.1    -3748.3          7496.5  

Fixed effects coefficients (95% CIs):
    Name            Estimate      SE            tStat      DF      pValue    
    'RU'              0.086966      0.004432     19.622    9475             0
    'VTU'           0.00014054    2.4546e-05     5.7256    9475    1.0622e-08
    'V'                0.11914     0.0024797     48.044    9475             0
    'VdecTU'        7.9781e-06    5.7809e-05    0.13801    9475       0.89024


    Lower          Upper     
       0.078278      0.095653
     9.2425e-05    0.00018866
        0.11428         0.124
    -0.00010534     0.0001213

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

         0
    0.0000
         0
    0.8902


w =

    0.0870
    0.0001
    0.1191
    0.0000


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat      deltaDF
    GLME       3     7502.5      7524    -3748.3                       
    ALTGLME    4     7504.5    7533.1    -3748.3    0.021757    1      


    pValue 
           
    0.88274

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 
[Warning: Final linear predictor from PL iterations is not feasible.] 
[> In classreg.regr.lmeutils.StandardGeneralizedLinearMixedModel/checkFinalPLSolution (line 1507)
  In classreg.regr.lmeutils.StandardGeneralizedLinearMixedModel/fitUsingPL (line 1724)
  In classreg.regr.lmeutils.StandardGeneralizedLinearMixedModel/fitUsingML (line 2018)
  In classreg.regr.lmeutils.StandardGeneralizedLinearMixedModel/refit (line 4322)
  In classreg.regr.lmeutils.StandardGeneralizedLinearMixedModel (line 4288)
  In GeneralizedLinearMixedModel/fitStandardLMEModel (line 1317)
  In GeneralizedLinearMixedModel/fitter (line 891)
  In classreg.regr.FitObject/doFit (line 94)
  In GeneralizedLinearMixedModel.fit (line 2411)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF
    GLME       3       7539    7560.5    -3766.5                     
    ALTGLME    4     7504.5    7533.1    -3748.3    36.509    1      


    pValue    
              
    1.5194e-09

rmse to w

r =

   -0.0289


p =

    0.8772

Insula_L
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Regression design matrix is rank deficient to within machine
precision.] 
[> In classreg.regr.CompactTermsRegression/checkDesignRank (line 35)
  In LinearModel.fit (line 1224)
  In fitlm (line 117)
  In multilinear_analysis (line 117)] 
[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 141)] 

ans = 


Generalized linear mixed-effects model fit by ML

Model information:
    Number of observations            9479
    Fixed effects coefficients           4
    Random effects coefficients          0
    Covariance parameters                0
    Distribution                    Binomial
    Link                            Probit
    FitMethod                       Laplace

Formula:
    C ~ RU + VTU + V + VdecTU

Model fit statistics:
    AIC       BIC       LogLikelihood    Deviance
    7504.5    7533.2    -3748.3          7496.5  

Fixed effects coefficients (95% CIs):
    Name            Estimate      SE            tStat        DF      pValue    
    'RU'              0.086965      0.004432       19.622    9475             0
    'VTU'           0.00014106     2.451e-05       5.7551    9475    8.9298e-09
    'V'                0.11914     0.0024797       48.045    9475             0
    'VdecTU'        1.0723e-07    7.3335e-05    0.0014622    9475       0.99883


    Lower          Upper     
       0.078278      0.095653
     9.3012e-05     0.0001891
        0.11428         0.124
    -0.00014364    0.00014386

Random effects covariance parameters:
Group: Error
    Name                      Estimate
    'sqrt(Dispersion)'        1       


ans =

         0
    0.0000
         0
    0.9988


w =

    0.0870
    0.0001
    0.1191
    0.0000


names =

  4×1 table

      Name  
    ________

    'RU'    
    'VTU'   
    'V'     
    'VdecTU'

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 151)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat        deltaDF
    GLME       3     7502.5      7524    -3748.3                         
    ALTGLME    4     7504.5    7533.2    -3748.3    2.1431e-06    1      


    pValue 
           
    0.99883

[Warning: Ignoring 'CovariancePattern' parameter since the model has no random
effects.] 
[> In classreg.regr.LinearLikeMixedModel/validateCovariancePattern (line 1615)
  In GeneralizedLinearMixedModel.fit (line 2392)
  In fitglme (line 389)
  In multilinear_analysis (line 159)] 

ans = 


    THEORETICAL LIKELIHOOD RATIO TEST

    Model      DF    AIC       BIC       LogLik     LRStat    deltaDF
    GLME       3     7539.8    7561.2    -3766.9                     
    ALTGLME    4     7504.5    7533.2    -3748.3    37.236    1      


    pValue    
              
    1.0467e-09

rmse to w

r =

    0.0418


p =

    0.8233


ans =

  6×10 table

            region              p_uncorr       p_corr      BIC_orig    BIC_both      p_comp      BIC_dec     p_comp2       p_ax        r_ax   
    _______________________    __________    __________    ________    ________    __________    _______    __________    _______    _________

    'Parietal_Inf_R'              0.99871             1    7524        7533.2         0.99833      7524        0.99833        NaN          NaN
    'Parietal_Inf_L'              0.99902             1    7524        7533.2         0.99939      7524        0.99939        NaN          NaN
    'Location not in atlas'      0.062754       0.32217    7524        7530.1        0.082067    7561.7     1.7585e-10    0.52421      0.11886
    'Precentral_L'             2.9177e-13    1.7506e-12    7524        7480.9      4.7806e-13      7556              0    0.65519     0.083496
    'Precentral_R'                0.89024             1    7524        7533.1         0.88274    7560.5     1.5194e-09     0.8772    -0.028935
    'Insula_L'                    0.99883             1    7524        7533.2         0.99883    7561.2     1.0467e-09     0.8233     0.041806

