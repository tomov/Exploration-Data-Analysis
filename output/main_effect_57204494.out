
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_RU_tommy.mat
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/tommy_Insula_L_-30_16_-8_r=10mm.nii

p =

    0.7303


t =

    0.3480


b =

  Columns 1 through 7

    0.0101    0.0285   -0.0668    0.1190   -0.0008    0.0577   -0.0042

  Columns 8 through 14

   -0.0611    0.1386    0.0015   -0.0553   -0.0197    0.0326   -0.0087

  Columns 15 through 21

   -0.0545    0.0146   -0.0032   -0.0147   -0.0283    0.0038    0.0615

  Columns 22 through 28

    0.0201    0.0125   -0.0413    0.0049   -0.0387    0.0354    0.0245

  Columns 29 through 31

   -0.0473   -0.0346    0.0055

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/tommy_Insula_R_32_22_-8_r=10mm.nii

p =

    0.0937


t =

    1.7310


b =

  Columns 1 through 7

    0.0661    0.0295   -0.0339    0.1243   -0.0019    0.1048    0.0097

  Columns 8 through 14

   -0.0061    0.1677   -0.0279   -0.0680   -0.0015   -0.0002    0.0393

  Columns 15 through 21

   -0.0376   -0.0108   -0.0048    0.0131   -0.0543   -0.0236    0.0983

  Columns 22 through 28

    0.0094    0.0294   -0.0127    0.0404    0.0031    0.0670    0.0239

  Columns 29 through 31

    0.0075   -0.0545    0.0191

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/tommy_dACC_R_8_16_46_r=10mm.nii

p =

    0.1082


t =

   -1.6555


b =

  Columns 1 through 7

    0.0576    0.0466   -0.1013    0.0899    0.0158    0.0566   -0.0666

  Columns 8 through 14

   -0.0494    0.0894   -0.0077   -0.1128   -0.0203   -0.0068   -0.0082

  Columns 15 through 21

   -0.0345   -0.0196   -0.0061   -0.0465   -0.0484   -0.0447    0.0958

  Columns 22 through 28

    0.0193   -0.0299   -0.1475   -0.0460   -0.0692    0.0232    0.0106

  Columns 29 through 31

   -0.0632   -0.0923   -0.0352

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/Ca.nii

p =

    0.4173


t =

   -0.8225


b =

  Columns 1 through 7

   -0.0143    0.0059   -0.0128    0.1398    0.0149   -0.0157    0.0186

  Columns 8 through 14

   -0.0559    0.0452   -0.0520   -0.0618   -0.0134   -0.0179   -0.0396

  Columns 15 through 21

   -0.0234   -0.0075   -0.0024   -0.0028   -0.0112   -0.0227    0.0727

  Columns 22 through 28

    0.0099   -0.0119   -0.0606    0.0204    0.0179   -0.0249    0.0071

  Columns 29 through 31

   -0.0094   -0.0586   -0.0188

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/Pu.nii

p =

    0.4161


t =

   -0.8247


b =

  Columns 1 through 7

    0.0035    0.0454   -0.0008    0.1303   -0.0260   -0.0013   -0.0102

  Columns 8 through 14

   -0.0691    0.0567   -0.0183   -0.0339    0.0054    0.0095   -0.0092

  Columns 15 through 21

   -0.0690    0.0177   -0.0071    0.0298   -0.0275    0.0029    0.0360

  Columns 22 through 28

   -0.0208    0.0102   -0.0994   -0.0085   -0.0449   -0.0226    0.0261

  Columns 29 through 31

   -0.0673   -0.0293   -0.0057

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
masks/NAC.nii

p =

    0.1171


t =

   -1.6135


b =

  Columns 1 through 7

   -0.0835   -0.0600    0.0268    0.0926   -0.0027    0.0203    0.0262

  Columns 8 through 14

   -0.0653    0.1089   -0.0329   -0.0869   -0.0674    0.0236   -0.0413

  Columns 15 through 21

   -0.0719    0.0049   -0.0420   -0.0227   -0.0455    0.0216    0.0102

  Columns 22 through 28

   -0.0391    0.0129   -0.0505    0.0601   -0.0199    0.0025   -0.0170

  Columns 29 through 31

   -0.0809   -0.0212    0.0001


ans =

  6×4 table

                  Var1                   p_uncorr    p_corr         m     
    _________________________________    ________    _______    __________

    'tommy_Insula_L_-30_16_-8_r=10mm'     0.73027    0.99961     0.0029598
    'tommy_Insula_R_32_22_-8_r=10mm'     0.093723    0.44593      0.016603
    'tommy_dACC_R_8_16_46_r=10mm'         0.10824    0.49709     -0.017782
    'Ca'                                   0.4173    0.96085    -0.0059787
    'Pu'                                  0.41606    0.96035    -0.0063683
    'NAC'                                  0.1171    0.52635     -0.014194

