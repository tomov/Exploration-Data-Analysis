
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'dlpfc'
        % clusters = masks from paper
        masks = dlpfc_2012_create_masks(false);

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    bs{i} = b;
    cis{i} = ci;
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

if exist('region', 'var')
    masknames = region';
end
table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_TU_RU_-_trial.mat
bspm_extract_clusters(/ncf/gershman/Lab/Exploration/glmOutput/model21/con5/spmT_0001.nii, 0.001000, +, 0.050000, 20, 1, 30, /ncf/gershman/Lab/scripts/ccnl-fmri-2018/atlases, AAL2)
[Warning: No voxels found after cluster FWE correction. Setting extent threshold
= 5.] 
[> In ccnl_extract_clusters>bspm_extract_clusters (line 146)
  In ccnl_extract_clusters (line 85)
  In main_effect (line 36)] 
  Columns 1 through 6

    'Positive'    'Location not in ...'    [102]    [4.9221]    [ 22]    [ 36]
            []    'Frontal_Mid_2_R'        [177]    [4.7206]    [ 34]    [ 50]
            []    'Parietal_Inf_R'         [ 49]    [4.4973]    [ 52]    [-58]
            []    'Location not in ...'    [  7]    [4.0179]    [-52]    [-56]
            []    'Frontal_Sup_2_L'        [  6]    [4.0130]    [-20]    [ 48]
            []    'Frontal_Mid_2_R'        [ 48]    [3.7128]    [ 42]    [ 26]
            []    'Frontal_Mid_2_L'        [ 55]    [3.6813]    [-34]    [ 48]

  Column 7

    [ -2]
    [-10]
    [ 50]
    [ 52]
    [-12]
    [ 38]
    [ -4]

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_22_36_-2_r=10mm.nii

p =

    0.6471


t =

    0.4625


b =

  Columns 1 through 7

    0.0292   -0.0306   -0.0181    0.0259    0.0012    0.0235   -0.0428

  Columns 8 through 14

    0.0395    0.0177   -0.0700   -0.0289   -0.0152    0.0232   -0.0427

  Columns 15 through 21

   -0.0401    0.0214    0.0431    0.0048    0.0102    0.0329    0.0571

  Columns 22 through 28

    0.0114    0.0013   -0.0080   -0.0247    0.0029    0.0141   -0.0144

  Columns 29 through 31

   -0.0410    0.0811    0.0219

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_34_50_-10_r=10mm.nii

p =

    0.6328


t =

    0.4827


b =

  Columns 1 through 7

    0.1014    0.0427   -0.1323    0.0973   -0.0833    0.2671    0.1203

  Columns 8 through 14

    0.1499    0.0454    0.0301   -0.0068    0.1296   -0.1510   -0.0978

  Columns 15 through 21

   -0.2575    0.0026    0.2044   -0.1840    0.0189    0.0515    0.1092

  Columns 22 through 28

    0.0340   -0.0866    0.0702    0.0774    0.0286   -0.0109   -0.0587

  Columns 29 through 31

   -0.2068    0.2017   -0.1620

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_52_-58_50_r=10mm.nii

p =

    0.0553


t =

    1.9940


b =

  Columns 1 through 7

   -0.0328   -0.0330   -0.0653    0.0831   -0.3309    0.1916    0.2585

  Columns 8 through 14

    0.1481    0.2068    0.2670    0.1498    0.1526   -0.1987   -0.0040

  Columns 15 through 21

   -0.1443    0.1873    0.3046   -0.0629    0.1017    0.0871    0.1699

  Columns 22 through 28

    0.0461    0.1777    0.2276   -0.0002    0.0276   -0.2088    0.0367

  Columns 29 through 31

   -0.2396    0.1544    0.1236

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-52_-56_52_r=10mm.nii

p =

    0.1355


t =

    1.5339


b =

  Columns 1 through 7

   -0.0629    0.0919   -0.2589    0.0896   -0.1671    0.1534    0.1786

  Columns 8 through 14

    0.0738    0.3527    0.4398    0.1095    0.0337   -0.0436   -0.0788

  Columns 15 through 21

   -0.0279    0.0324    0.0634   -0.1004    0.0515    0.0418    0.1113

  Columns 22 through 28

    0.1059   -0.0266    0.1412   -0.0390    0.0099   -0.0109   -0.0224

  Columns 29 through 31

   -0.1327    0.2323   -0.1153

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-20_48_-12_r=10mm.nii

p =

    0.0132


t =

    2.6355


b =

  Columns 1 through 7

    0.0379    0.0270   -0.0191    0.0710    0.0287    0.1466    0.0333

  Columns 8 through 14

    0.0991    0.0727    0.0436    0.0127    0.0768   -0.0278   -0.0412

  Columns 15 through 21

    0.0037   -0.0424    0.0287   -0.0607   -0.0090    0.0480    0.0967

  Columns 22 through 28

    0.0013    0.0089    0.1014   -0.0215   -0.0013    0.0002    0.0277

  Columns 29 through 31

   -0.0055    0.1424   -0.0729

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_42_26_38_r=10mm.nii

p =

    0.0058


t =

    2.9706


b =

  Columns 1 through 7

    0.1040    0.0951   -0.1630    0.2076   -0.0139    0.2638    0.3002

  Columns 8 through 14

    0.2195    0.2102    0.0777    0.0660    0.1548   -0.1101    0.1423

  Columns 15 through 21

   -0.2857    0.0225    0.4143   -0.0815    0.1419    0.0779    0.1169

  Columns 22 through 28

    0.0591    0.0542    0.0452    0.1108   -0.0317    0.0233    0.0511

  Columns 29 through 31

   -0.2112    0.3592    0.1322

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_RU_-_trial_-34_48_-4_r=10mm.nii

p =

    0.4231


t =

    0.8122


b =

  Columns 1 through 7

    0.1368    0.1029   -0.2511    0.1616   -0.0219    0.1350    0.0080

  Columns 8 through 14

    0.1097    0.0367    0.2348   -0.0727    0.0757   -0.0518   -0.1009

  Columns 15 through 21

   -0.0822   -0.0086    0.1228   -0.1222   -0.0891    0.0148    0.0580

  Columns 22 through 28

   -0.0516    0.0049    0.0327    0.0177    0.0321   -0.0024    0.0614

  Columns 29 through 31

   -0.0952    0.2287   -0.1309


ans =

  7×4 table

             Var1              p_uncorr      p_corr         m    
    _______________________    _________    ________    _________

    'Location not in atlas'      0.64706     0.99932    0.0027751
    'Frontal_Mid_2_R'            0.63281      0.9991     0.011115
    'Parietal_Inf_R'            0.055314     0.32855     0.057463
    'Location not in atlas'      0.13554     0.63924     0.039556
    'Frontal_Sup_2_L'           0.013168    0.088611      0.02604
    'Frontal_Mid_2_R'          0.0058028    0.039919     0.082346
    'Frontal_Mid_2_L'            0.42307     0.97873     0.015924

