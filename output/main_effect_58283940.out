
                            < M A T L A B (R) >
                  Copyright 1984-2017 The MathWorks, Inc.
                   R2017a (9.2.0.556344) 64-bit (glnxa64)
                               March 27, 2017

 
For online documentation, see http://www.mathworks.com/support
For product information, visit www.mathworks.com.
 
--------------------- BEGIN FILE main_effect.m-------------------
function main_effect(glmodel, regressor, contrast)

printcode;

EXPT = exploration_expt();

data = load_data;

filename = sprintf('main_effect_glm%d_%s_%s.mat', glmodel, regressor, replace(contrast, ' ', '_'));
disp(filename);


% get ROI masks
switch contrast
    case 'badre'
        % clusters = masks from paper
        masks = badre_2012_create_masks(false);
        %masks = masks(1); % TODO use all masks

    case 'dlpfc'
        % clusters = masks from paper
        masks = dlpfc_2012_create_masks(false);

    case 'tommy'
        % clusters = masks from paper
        masks = tommy_2017_create_masks(false);

    otherwise
        % group-level settings
        p = 0.001;
        alpha = 0.05;
        Dis = 20;
        Num = 1; % # peak voxels per cluster; default in bspmview is 3
        direct = '+';

        [V, Y, C, CI, region, extent, stat, mni, cor, results_table] = ccnl_extract_clusters(EXPT, glmodel, contrast, p, direct, alpha, Dis, Num);

        r = 10 / 1.5; % 10 mm radius

        % create spherical masks around peak voxel of each cluster (intersected with cluster)
        %
        for c = 1:length(region)
            masks{c} = sprintf('sphere_glm%d_%s_%d_%d_%d_r=%dmm.nii', glmodel, replace(contrast, ' ', '_'), mni(c,1), mni(c,2), mni(c,3), round(r * 1.5));
            cmask = CI == CI(cor(c,1), cor(c,2), cor(c,3));
            ccnl_create_spherical_mask(cor(c,1), cor(c,2), cor(c,3), r, masks{c}, cmask);
        end
        masknames = region';
end


clear stat;


for i = 1:length(masks)
    mask = masks{i};
    [~, masknames{i}, ~] = fileparts(mask);

    clear b;
    for s = 1:length(data)
        b(s) = mean(ccnl_get_beta(EXPT, glmodel, regressor, mask, s));
    end

    [h, p, ci, stats] = ttest(b);
    t = stats.tstat;
    ps(i,:) = p;
    m(i,:) = mean(b);
    disp(mask);
    p
    t
    b
    bs{i} = b;
    cis{i} = ci;
    stat{i} = stats;
end

p_uncorr = ps;
p_corr = 1 - (1 - ps) .^ length(ps);

save(filename, '-v7.3');

if exist('region', 'var')
    masknames = region';
end
table(masknames', p_uncorr, p_corr, m)

--------------------- END FILE main_effect.m-------------------
       datadir: '/ncf/gershman/Lab/Exploration/subjects/180725_UEP_001/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_002/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180727_UEP_003/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_004/preproc'
    structural: 'struct.nii'
    functional: {1×6 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180730_UEP_005/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180801_UEP_006/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180802_UEP_007/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_008/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180803_UEP_009/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP010/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_011/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_012/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_013/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_014/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180804_UEP_015/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_016/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_017/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_018_2/preproc'
    structural: 'struct.nii'
    functional: {1×7 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_019/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_020/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180805_UEP_021/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_022/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180806_UEP_023/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_024/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_025/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180807_UEP_026/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_027/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_028/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180808_UEP_029/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_030/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

       datadir: '/ncf/gershman/Lab/Exploration/subjects/180809_UEP_031/preproc'
    structural: 'struct.nii'
    functional: {1×8 cell}

main_effect_glm21_RU_TU_-_trial.mat
bspm_extract_clusters(/ncf/gershman/Lab/Exploration/glmOutput/model21/con6/spmT_0001.nii, 0.001000, +, 0.050000, 20, 1, 30, /ncf/gershman/Lab/scripts/ccnl-fmri-2018/atlases, AAL2)
  Columns 1 through 6

    'Positive'    'Parietal_Inf_R'         [2042]    [7.5078]    [ 38]    [-46]
            []    'Parietal_Inf_L'         [1521]    [7.2982]    [-46]    [-40]
            []    'Location not in ...'    [ 468]    [6.2314]    [ 22]    [ -2]
            []    'Precentral_L'           [ 282]    [5.7913]    [-42]    [  2]
            []    'Precentral_R'           [ 258]    [4.8413]    [ 46]    [  8]
            []    'Insula_L'               [ 268]    [4.8153]    [-30]    [ 22]

  Column 7

    [44]
    [48]
    [52]
    [28]
    [30]
    [ 2]

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_38_-46_44_r=10mm.nii

p =

    0.6291


t =

    0.4880


b =

  Columns 1 through 7

    0.0084    0.1621   -0.1502    0.1720    0.2292    0.1522   -0.0120

  Columns 8 through 14

    0.0201    0.1532    0.0225   -0.0109   -0.0441   -0.0623    0.0077

  Columns 15 through 21

   -0.2517    0.0752    0.0632   -0.2304    0.0039   -0.0572    0.2138

  Columns 22 through 28

    0.0962   -0.0932   -0.0179   -0.1173    0.0636    0.0141   -0.0058

  Columns 29 through 31

    0.0807   -0.1192   -0.0462

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-46_-40_48_r=10mm.nii

p =

    0.4102


t =

   -0.8351


b =

  Columns 1 through 7

    0.0595    0.2292   -0.1429    0.1710   -0.0564    0.1590   -0.0970

  Columns 8 through 14

   -0.0181    0.2915   -0.1029   -0.1070   -0.0344    0.0258    0.0067

  Columns 15 through 21

   -0.2381   -0.0194    0.0460   -0.1222    0.0102   -0.0578    0.1157

  Columns 22 through 28

    0.0391   -0.1418   -0.1572   -0.0493    0.0028   -0.0559   -0.0078

  Columns 29 through 31

   -0.0507   -0.1349   -0.1125

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_22_-2_52_r=10mm.nii

p =

    0.3238


t =

   -1.0032


b =

  Columns 1 through 7

    0.0691    0.0178   -0.0666    0.1614    0.0120    0.0455   -0.0538

  Columns 8 through 14

   -0.0681    0.0666   -0.0119   -0.0817   -0.0329    0.0148    0.0163

  Columns 15 through 21

   -0.0556   -0.0766    0.0258   -0.0634   -0.0070   -0.0006    0.0996

  Columns 22 through 28

    0.0296   -0.0044   -0.1399   -0.0140   -0.0363    0.0245   -0.0395

  Columns 29 through 31

   -0.0284   -0.1053   -0.0440

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-42_2_28_r=10mm.nii

p =

    0.3256


t =

   -0.9994


b =

  Columns 1 through 7

   -0.0526    0.1207   -0.2277    0.2357    0.0500    0.0678    0.0084

  Columns 8 through 14

   -0.1245    0.1142   -0.0315   -0.0874   -0.0463    0.0145    0.0149

  Columns 15 through 21

   -0.0165    0.0549   -0.0096   -0.0002   -0.0073   -0.0839    0.0523

  Columns 22 through 28

    0.0383   -0.1246   -0.1187   -0.0682   -0.0061   -0.0412   -0.0115

  Columns 29 through 31

   -0.0826   -0.1074   -0.0148

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_46_8_30_r=10mm.nii

p =

    0.7204


t =

   -0.3613


b =

  Columns 1 through 7

    0.0557    0.0762   -0.1535    0.1914    0.0906    0.1531   -0.0407

  Columns 8 through 14

   -0.0078    0.0509   -0.0295   -0.1305    0.0605   -0.0175    0.0653

  Columns 15 through 21

   -0.0646    0.0103   -0.0185   -0.0661   -0.0014   -0.0062    0.2177

  Columns 22 through 28

    0.0126   -0.0216   -0.1555   -0.0473   -0.0519    0.0758   -0.0243

  Columns 29 through 31

   -0.1828   -0.2030   -0.0380

mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
mask
sphere_glm21_TU_-_trial_-30_22_2_r=10mm.nii

p =

    0.1427


t =

    1.5051


b =

  Columns 1 through 7

    0.0157    0.0498   -0.1013    0.1791    0.0316    0.0567   -0.0119

  Columns 8 through 14

   -0.0483    0.1793    0.0342   -0.0970   -0.0064    0.0307   -0.0126

  Columns 15 through 21

    0.0420    0.0632   -0.0286    0.0028   -0.0195    0.0127    0.1400

  Columns 22 through 28

    0.0474    0.0199   -0.0675   -0.0020    0.0094    0.0176    0.0316

  Columns 29 through 31

   -0.0245   -0.0109    0.0021


ans =

  6×4 table

             Var1              p_uncorr    p_corr         m     
    _______________________    ________    _______    __________

    'Parietal_Inf_R'           0.62908      0.9974      0.010318
    'Parietal_Inf_L'           0.41025     0.95792     -0.017736
    'Location not in atlas'    0.32377     0.90437     -0.011199
    'Precentral_L'             0.32561     0.90593     -0.015829
    'Precentral_R'             0.72038     0.99952    -0.0064734
    'Insula_L'                 0.14274     0.60312      0.017267

